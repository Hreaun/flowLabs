import lab7/expr;
import lab7/derivative;

ar2s(expr: ArExp) -> string {
    switch (expr) {
        ArSum(l, r): {
            "(" + ar2s(l) + " + " + ar2s(r) + ")";
        }
        ArSub(l, r): {
            "(" + ar2s(l) + " - " + ar2s(r) + ")";
        }
        ArProd(l, r): {
            "(" + ar2s(l) + " * " + ar2s(r) + ")";
        }
        ArDiv(l, r): {
            "(" + ar2s(l) + " / " + ar2s(r) + ")";
        }
        ArNeg(v): {
            "(-" + ar2s(v) + ")";
        }
        ArInt(v): i2s(v);
        ArVar(v): v;
    }
}



main() {
    s = "((-a + 16) / (c + 6))";
    vars = setTree(makeTree(), "a", 8) |> (\t -> setTree(t, "c", 10));
    switch(ar2i(s2ar(s), vars)) {
        Some(v): println(fract2s(v));
        None(): println("None");
    }

    expr = "(((2 * y) + y) / (y - (2*y)))";
    println(ar2s(simplify(derive(s2ar(expr), ArVar("y")))));

    quit(0);
}